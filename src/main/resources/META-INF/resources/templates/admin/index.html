<!DOCTYPE html>
<html lang="en">
<head>
    <title>Interfejs usługodawcy</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>

<nav class="navbar navbar-default navbar-static-top">
    <div class="container">
        <div class="navbar-header"><a class="navbar-brand">System Administratora</a></div>
        <ul class="nav navbar-nav navbar-right">
            <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Typ użytkownika <span class="caret"></span></a>
                <ul class="dropdown-menu">
                    <li><a href="../">Usługodawca</a></li>
                    <li><a href="../userView/my.html">Użytkownik</a></li>
                    <li><a href="../admin">Administrator</a></li>
                </ul>
            </li>
        </ul>

        </div>
    </div>
</nav>
<div class="container">

    <div class="jumbotron">
        <h2>Usługodawcy</h2>
        <table class="table table-striped">
            <thead>
            <tr>
                <th>ID</th>
                <th >Nazwa</th>
                <th>Nip</th>
                <th >Telefon</th>
                <th >Adres Firmy</th>
                <th >Email</th>
                <th></th>

            </tr>
            </thead>
            <tbody id="providers">

            </tbody>
        </table>
        <script>
            var edytujUslugodawce = function (id) {

                $.ajax({
                    url: 'http://localhost:8080/admin/edit-provider/?id='+id
                })
            }
        </script>
<script>
            $.get('http://localhost:8080/admin/providers', function (data) {
                console.log(data);
                var tbody = document.getElementById("providers");
                for (var i = 0; i < data.length; i++) {
                    var tr = document.createElement("tr");
                    var td0 = document.createElement("td");
                    var td1 = document.createElement("td");
                    var td2 = document.createElement("td");
                    var td3 = document.createElement("td");
                    var td4 = document.createElement("td");
                    var td5 = document.createElement("td");
                    var td7 = document.createElement("td");
                    //var td6 = document.createElement("td");


                    td0.textContent = data[i].id;
                    td0.innerHTML = td0.textContent +' <button class="glyphicon glyphicon-remove" aria-hidden="true" onclick="usunUslugodawce( '+ data[i].id +')">' +
                        '</button>';
                    td1.textContent = data[i].name;
                    td2.textContent = data[i].nip;
                    td3.textContent = data[i].phoneNo;
                    td4.textContent = data[i].address;
                    td5.textContent = data[i].email;
                    //td6.textContent = data[i].zone.postalCode;

                    td7.innerHTML = '<a target="_blank" ' +
                        'href="localhost:8080/admin/edit-provider/?id='
                        +data[i].id+'' +
                        '" >Edytuj</a>';


                    tr.appendChild(td0);
                    tr.appendChild(td1);
                    tr.appendChild(td2);
                    tr.appendChild(td3);
                    tr.appendChild(td4);
                    tr.appendChild(td5);
                    //tr.appendChild(td6);
                    tr.appendChild(td7);
                    tbody.appendChild(tr);
                }
            })
        </script>
        <a href="../admin/new-provider.html">
            Dodaj usługodawce
            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
        </a>
    </div>
</div>
<div class="container">

    <div class="jumbotron">
        <h2>Użytkownicy</h2>
        <table class="table table-striped">
            <thead>
            <tr>
                <th >Id</th>
                <th >E-mail</th>
                <th >Imię</th>
                <th >Nazwisko</th>
                <th >Telefon</th>
                <th >Adres</th>
                <th >Login</th>
                <th >Hasło</th>
                <th >Strefa</th>

            </tr>
            </thead>
            <tbody id="users">

            </tbody>
            <script>
            var usunUzytkownika = function (id) {

                    $.ajax({
                        type: 'DELETE',
                        url: 'http://localhost:8080/admin/deletePerson/'+id
                    })
            }
            var usunUslugodawce = function (id) {

                $.ajax({
                    type: 'DELETE',
                    url: 'http://localhost:8080/admin/deleteProvider/'+id
                })
            }


                $.get('http://localhost:8080/admin/users', function (data) {
                    console.log(data);
                    var tbody = document.getElementById("users");
                    for (var i = 0; i < data.length; i++) {
                        var tr = document.createElement("tr");
                        var td0 = document.createElement("td");
                        var td1 = document.createElement("td");
                        var td2 = document.createElement("td");
                        var td3 = document.createElement("td");
                        var td4 = document.createElement("td");
                        var td5 = document.createElement("td");
                        var td6 = document.createElement("td");
                        var td7 = document.createElement("td");
                        var td8 = document.createElement("td");
                        var td9 = document.createElement("td");


                        td0.textContent = data[i].id;
                        td0.innerHTML = td0.textContent +' <button class="glyphicon glyphicon-remove" aria-hidden="true" onclick="usunUzytkownika( '+ data[i].id +')">' +
                            '</button>';
                        td1.textContent = data[i].email;
                        td2.textContent = data[i].name;
                        td3.textContent = data[i].surname;
                        td4.textContent = data[i].phoneNo;
                        td5.textContent = data[i].address;
                        td6.textContent = data[i].username;
                        td7.textContent = data[i].password;
                        if (data[i].zone)
                            td8.textContent = data[i].zone.id;
                        else
                            td8.textContent = null;
                        td9.innerHTML = '<a target="_blank" ' +
                            'href="localhost:8080/admin/edit-user/?id='
                            +data[i].id+'' +
                            '" >Edytuj</a>';


                        tr.appendChild(td0);
                        tr.appendChild(td1);
                        tr.appendChild(td2);
                        tr.appendChild(td3);
                        tr.appendChild(td4);
                        tr.appendChild(td5);
                        tr.appendChild(td6);
                        tr.appendChild(td7);
                        tr.appendChild(td8);
                        tr.appendChild(td9);
                        tbody.appendChild(tr);
                    }
                })
            </script>
        </table>
        <a href="../admin/new-user.html">
            Dodaj użytkownika
             <span class="glyphicon glyphicon-plus" aria-hidden="true"></span></a>
    </div>
    <div class="jumbotron">
        <h2>Zlecenia po zmianach</h2>
        <table class="table table-striped">
            <thead>
            <tr>
                <th >ID</th>
                <th>Opis</th>
                <th >Data Utworzenia</th>
                <th >Ocena</th>
                <th >Strefa</th>

            </tr>
            </thead>
            <tbody id="cases">
            <tr>
                <th><a>1<span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a></th>
                <td>Dziura w drodzie na ul. Kolorowej</td>
                <td>20.09.2017</td>
                 <td>Brak</td>
                 <td>01-003</td>
            </tr>
            <tr>
                <th><a>2<span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a></th>
                <td>Uszkodzony przystanek autobusowy Metro Pole Motowskie 05</td>
                <td>18.10.2017</td>
                <td>8</td>
                <td>02-034</td>
            </tr>

            </tbody>
        </table>
    </div>
</div>
</div>
<script>
    $.get('http://localhost:8080/serviceProvider/4/orders', function (data) {
        console.log(data);
        var tbody = document.getElementById("cases");
        for (var i = 0; i < data.length; i++) {
            var tr = document.createElement("tr");
            var td0 = document.createElement("td");
            var td1 = document.createElement("td");
            var td2 = document.createElement("td");
            var td3 = document.createElement("td");
            var td4 = document.createElement("td");


            td0.textContent = data[i].id;
            td0.innerHTML = td0.textContent +'<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>\n';
            td1.textContent = data[i].description;
            td2.textContent = '13.11.2017';//data[i].creation_date;
            td3.textContent = data[i].rating === null ? 'Brak' : data[i].rating;
            td4.textContent = '01-003';
            tr.appendChild(td0);
            tr.appendChild(td1);
            tr.appendChild(td2);
            tr.appendChild(td3);
            tr.appendChild(td4);
            tbody.appendChild(tr);
        }
    })
</script>


</body>
</html>