<!DOCTYPE html>
<html lang="en">
<head>
    <title>Interfejs usługodawcy</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>

<nav class="navbar navbar-default navbar-static-top">
    <div class="container">
        <div class="navbar-header">
            <a class="navbar-brand">System Administratora</a>
         </div>
        <ul class="nav navbar-nav navbar-right">
            <li><a href="/logout">Wyloguj</a></li>
        </ul>
    </div>
</nav>
<div class="container">
    <div class="jumbotron">
        <h2>Dodaj usługodawce</h2>
        <br><br>
        <h4>Nazwa:
            <input id="name" style="width: 70%;">
        </h4>
        <h4>NIP:        
          <input id="nip" style="width: 70%;">
        </h4>
        <h4>Telefon:
          <input id="phoneNumber" style="width: 70%;">
        </h4>
        <h4>Adres:
          <input id="address" style="width: 70%;">
        </h4>
        <h4>Email:
                <input id="email" style="width: 70%;">
        </h4>
        <h4>Strefa:
          <input id="zone" style="width: 70%;">
        </h4>


        <button type="button" class="btn btn-success" onclick="dodajUslugodawce();">Dodaj</button>

        <div class="modal fade" id="successModal" role="dialog">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Dodanie usługodawcy</h4>
                    </div>
                    <div class="modal-body">
                        <p>Operacja zakończona pomyślnie.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Zamknij</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="failModalNIP" role="dialog">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Błąd !</h4>
                    </div>
                    <div class="modal-body">
                        <p>Operacja zakończona niepowodzeniem. Sprawdź poprawność danych. Nip powinien sie skałać z 10 cyfr</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Zamknij</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="failModalPostalCode" role="dialog">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Błąd !</h4>
                    </div>
                    <div class="modal-body">
                        <p>Operacja zakończona niepowodzeniem. Sprawdź poprawność danych. Kod pocztowy powinien mieć foramt 00-000.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Zamknij</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="failModalEmail" role="dialog">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Błąd !</h4>
                    </div>
                    <div class="modal-body">
                        <p>Operacja zakończona niepowodzeniem. Sprawdź poprawność danych. Email powinien mieć foramt przykład@domena.pl.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Zamknij</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="failModalTelefon" role="dialog">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Błąd !</h4>
                    </div>
                    <div class="modal-body">
                        <p>Operacja zakończona niepowodzeniem. Sprawdź poprawność danych. Telefon powinien mieć foramt +48123123123.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Zamknij</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="failModal" role="dialog">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Błąd !</h4>
                    </div>
                    <div class="modal-body">
                        <p>Operacja zakończona niepowodzeniem. Sprawdź poprawność danych.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Zamknij</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="failModalNoCode" role="dialog">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Błąd !</h4>
                    </div>
                    <div class="modal-body">
                        <p>Operacja zakończona niepowodzeniem. Uzupelnij wszystkie pola.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Zamknij</button>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
<script>

var dodajUslugodawce = function () {
        var name = document.getElementById('name').value;
        var nip = document.getElementById('nip').value;
        var phoneNumber = document.getElementById('phoneNumber').value;
        var address = document.getElementById('address').value;
        var zone = document.getElementById("zone").value;
        var email = document.getElementById("email").value;
    function validForm(inputDOMElement) {
        if (!inputDOMElement) {
            $("#failModalNoCode").modal();
            return false
        } else {
            return true
        }
    }

    function validPostalCode(inputDOMElement) {
        var codeReg = /[0-9]{2}[-][0-9]{3}/g;
        if (codeReg.test(inputDOMElement)) {

            return true
        } else {
            console.log(codeReg);
            console.log(inputDOMElement);

            $("#failModalPostalCode").modal();
            return false
        }
    }
    function validNIPCode(inputDOMElement) {
        var codeReg = /[0-9]{10}/g;
        if (codeReg.test(inputDOMElement)) {
            return true
        } else {
            console.log(codeReg);
            console.log(inputDOMElement);
            $("#failModalNIP").modal();
            return false
        }
    }
    function validEmailCode(inputDOMElement) {
        var codeReg = /^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;
        if (codeReg.test(inputDOMElement)) {
            return true
        } else {
            console.log(codeReg);
            console.log(inputDOMElement);
            $("#failModalEmail").modal();
            return false
        }
    }
    function validTelephone(inputDOMElement) {
        var codeReg = /[+][0-9]{11}/g;
        if (codeReg.test(inputDOMElement)) {
            return true
        } else {
            console.log(codeReg);
            console.log(inputDOMElement);
            $("#failModalTelefon").modal();
            return false
        }
    }
    validPostalCode(zone) ;
    validTelephone(phoneNumber) ;
    validNIPCode(nip);
    validForm(address);
    validForm(name);
    validEmailCode(email)
    var isValid =
        validPostalCode(zone) &&
        validTelephone(phoneNumber) &&
        validNIPCode(nip)&&
        validForm(address)&&
        validForm(name)&&
        validEmailCode(email)
    if (isValid) {
        $.ajax({
            type: 'POST',
            url: 'http://localhost:8080/admin/addProvider',
            data: {
                nip : nip,
                telefon : phoneNumber,
                siedzibaFirmy : address,
                nazwa : name,
                kodStrefy :zone,
                email : email
            },
            success: function (response) {
                console.log(response);
                $("#successModal").modal();
            },
            error: function (response) {
                console.log(response);
                $("#failModal").modal();
            }
        });

    };}


</script>
</body>
</html>